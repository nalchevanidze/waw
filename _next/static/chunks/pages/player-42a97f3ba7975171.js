(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[887],{8363:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/player",function(){return n(6084)}])},6084:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>W});var r=n(1085),a=n(4041),o=function(e,t){var n=e.radius,r=e.center,a=t*Math.PI/180,o=r.x+n*Math.cos(a),u=r.y+n*Math.sin(a);return o.toFixed(2)+" "+u.toFixed(2)},u=function(e,t,n){var r=t.start,a=t.end;void 0===n&&(n=!0);var u=e.radius,c=o(e,r),i=o(e,a),s=Math.floor(Math.abs(a-r)/180)%2,l=Number(r-a<0),f=n?[s,l]:[1-s,1-l];return"".concat(c," A").concat(u," ").concat(u," 0 ").concat(f.join(" ")," ").concat(i)},c=function(e){return(360+e)%360},i=function(e){var t=e.start;return s({start:e.end,end:t})},s=function(e){var t=e.start,n=e.end,r=c(t),a=c(n);return{start:r,end:a>r?a:a+360}},l=function(e,t,n){var r=t.start,a=t.end,o=r+(a-r)*e;return n?{start:r,end:o}:{start:o,end:a}},f=function(e,t){var n=e.center,r=e.radius,a=r[0],o=r[1],c=t.start,s=t.end,l=i(t);return"M ".concat(d(e,c)," ").concat(u({center:n,radius:a},t)," L ").concat(d(e,s)," ").concat(u({center:n,radius:o},l,!1))},d=function(e,t){var n=e.center,r=e.radius,a=r[0],u=r[1];return o({center:n,radius:a},t)+" "+o({center:n,radius:u},t)},p=function(e,t){var n=t.x,r=t.y;return 360-c(180*Math.atan2(n-e.x,r-e.y)/Math.PI-90)},h=function(e,t,n){var r=n.start,a=n.end,o=p(t,e)-r;return(o<0?o+360:o)/(a-r)},v=function(e,t){var n=e.x,r=e.y;return{x:n-t.x,y:r-t.y}},m=function(e,t){var n=v(e,t);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))},y=function(e,t,n){var r=t.start,a=(t.end-r)/(e.length-1);return Array.from(e).map(function(e,t){return n(e,r+t*a)}).join("")+" "},w=function(e,t,n){var r=t.start,a=(t.end-r)/(e.length-1);return e.map(function(e,t){return n(e,r+t*a)})},g=function(e,t,n){var r=t.center,a=t.radius,c=a[0],s=a[1];return"M "+y(e,n,function(e,t){return" "+o({center:r,radius:Math.max(c,c+e/256*(s-c))},t)})+" "+u({center:r,radius:c},i(n),!1)+"Z"},b=function(e,t,n){var r=t.center,a=t.radius,o=a[0],u=(a[1]-o)/128;return y(e,n,function(e,t){return" M "+d({center:r,radius:[o,o+u*e]},t)})},E=function(e,t,n,r){var a=t.center,u=t.radius;return w(e,r,function(e,t){return o({center:a,radius:u+e*n},t)})},x=function(e,t){var n=t.center,r=t.radius,a=r[0],o=r[1],u=t.sector;if(e.length<2)return"";var c=(o-a)*.9,i={center:n,radius:(o+a)/2},s=E(e,i,-c,u).reverse().join(" "),l=E(e,i,c,u).join(" ");return"M ".concat(s,"  ").concat(l,"z")},O={},S=function(e){var t=a.useState([]),n=t[0],r=t[1];return a.useEffect(function(){O[e]?r(O[e]):fetch(e).then(function(e){return e.json()}).then(function(t){O[e]=t,r(t)})},[e]),n};let M=function(e){var t=e.src,n=e.annulusSector;return a.createElement("path",{d:x(S(t),n),fillOpacity:.8})};var k=function(){return(k=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},A=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};let j=function(e){var t=e.annulus,n=e.sector,r=A(e,["annulus","sector"]);return a.createElement("path",k({},r,{d:f(t,n)}))},C=function(e){var t=e.annulus,n=e.sector;return a.createElement("path",{d:"M "+d(t,n.start),stroke:"#FFC107"})},F=function(e){var t=e.annulus,n=e.fr,r=e.spec,o=e.sector,u=e.sector2;return a.createElement("g",null,a.createElement("path",{d:g(r,t,u),fillOpacity:.6,fill:"#777",fillRule:"evenodd"}),a.createElement("path",{d:b(n,t,o),stroke:"#DDD",strokeWidth:.4}))};var P={paused:"M 115 97 l 0 10 8 -5Z",play:"M 115 97 v 10 m7 -10 v 10",stop:""},_="#777",q=function(e){var t=e.toggle,n=e.annulus,r=e.mode,o=e.time;return a.createElement("g",{onClick:t,fill:_,style:{cursor:"pointer"}},a.createElement("path",{d:P[r],strokeLinecap:"round",strokeLinejoin:"round",fillOpacity:"0",strokeWidth:"2px",stroke:_}),a.createElement("text",{x:n.center.x-6,y:n.center.y+8,fontSize:"18px",textAnchor:"middle",fontFamily:"sans-serif"},Math.floor(o/60)+":"+("0"+Math.floor(o)%60).slice(-2)),a.createElement("circle",{cx:n.center.x,cy:n.center.y,r:n.radius[0],opacity:0}))};let N=function(e){var t=e.innerAnnulus,n=e.outerAnnulus,r=e.stageSector,o=e.toggle,u=e.state,c=u.pro,i=u.time,s=u.mode,f=u.freq,d=u.spec,p=l(c,r,!1);return a.createElement("g",null,a.createElement(F,{fr:f,spec:d,annulus:n,sector:r,sector2:p}),a.createElement(j,{annulus:t,sector:p,fill:"#FFF",fillOpacity:.8}),a.createElement(C,{annulus:t,sector:p}),a.createElement(q,{toggle:o,annulus:t,mode:s,time:i}))};var T=n(1276),B=function(e){var t=e.onChange,n=e.annulus,r=e.levelSector,o=e.stageSector,u=(0,a.useContext)(T.K),c=a.useState(!1),i=c[0],s=c[1],l=a.useState(.5),f=l[0],d=l[1],p=n.radius,h=p[0],v=p[1],y=n.center,w=function(){return s(!1)},g=function(e){if(i){var n=Math.min(.98,Math.max(.05,(m(u(e),y)-h)/(v-h)));d(n),t(Math.pow(n,2))}};a.useEffect(function(){return document.addEventListener("mouseup",w,!1),function(){return document.removeEventListener("mouseup",w,!1)}});var b={center:y,radius:[h+(v-h)*f,h]};return a.createElement("g",{fill:"#BBB",stroke:"#BBB",strokeWidth:.5,onMouseDown:function(e){s(!0),g(e)},onMouseMove:g},a.createElement(j,{annulus:b,sector:r,fillOpacity:.1,stroke:"#CCC"}),a.createElement(j,{annulus:b,sector:o,fillOpacity:.4}),a.createElement(j,{annulus:n,sector:r,fill:"black",fillOpacity:0}))},D=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function u(e){try{i(r.next(e))}catch(e){o(e)}}function c(e){try{i(r.throw(e))}catch(e){o(e)}}function i(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(u,c)}i((r=r.apply(e,t||[])).next())})},I=function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},u=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return u.next=c(0),u.throw=c(1),u.return=c(2),"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(c){return function(i){return function(c){if(n)throw TypeError("Generator is already executing.");for(;u&&(u=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},L=function(e,t){var n=this;this.render=function(){n.analyser&&(n.analyser.getByteFrequencyData(n.spec),n.analyser.getByteTimeDomainData(n.freq))},this.analyser=e.createAnalyser(),t.connect(this.analyser),this.freq=new Uint8Array(200),this.spec=new Uint8Array(400)},z={pro:0,time:0,mode:"stop",freq:new Uint8Array(40),spec:new Uint8Array(40)},V=function(){var e=this;this.mode="stop",this.allowed=!1,this.allowAudioContext=function(){e.allowed=!0,e.audio=new Audio,e.audio.crossOrigin="anonymous";var t=new AudioContext,n=t.createMediaElementSource(e.audio),r=t.createGain();n.connect(r),r.connect(t.destination),e.gain=r.gain,e.waveForm=new L(t,n),e.setVolume(.1)},this.setSrc=function(t){e.src!==t&&(e.src=t,e.audio&&(e.audio.src=t+".mp3"))},this.loadSource=function(){return new Promise(function(t){e.audio.src=e.src+".mp3",e.audio.addEventListener("canplaythrough",t,!0)})},this.loadAudio=function(){return D(e,void 0,void 0,function(){return I(this,function(e){switch(e.label){case 0:if(this.allowed)return[2];return this.allowAudioContext(),[4,this.loadSource()];case 1:return e.sent(),[2]}})})},this.play=function(){return D(e,void 0,void 0,function(){return I(this,function(e){switch(e.label){case 0:return[4,this.loadAudio()];case 1:return e.sent(),this.mode="play",this.audio.play(),[2]}})})},this.generateState=function(){var t=e.mode,n=e.audio.currentTime,r=n/e.audio.duration;return{time:n,pro:isNaN(r)?0:r,mode:t,freq:e.waveForm.freq,spec:e.waveForm.spec}},this.playNew=function(t){e.setSrc(t),e.allowed&&e.play()},this.setVolume=function(t){e.allowed&&e.gain.setValueAtTime(t,0)},this.playAt=function(t){return D(e,void 0,void 0,function(){var e;return I(this,function(n){switch(n.label){case 0:return[4,this.loadAudio()];case 1:return n.sent(),e=this.audio.duration*t,this.audio.currentTime=e,[2,{pro:t,time:e,mode:this.mode,freq:this.waveForm.freq,spec:this.waveForm.spec}]}})})},this.getState=function(){return e.allowed?("play"===e.mode&&e.waveForm.render(),e.generateState()):z},this.pause=function(){e.mode="paused",e.allowed&&e.audio.pause()},this.stop=function(){e.mode="stop",e.allowed&&(e.audio.pause(),e.audio.currentTime=0)},this.toggle=function(){"play"==e.mode?e.pause():e.play()}};let U=function(e){var t=e.annulus,n=e.sector,r=e.onClick,o=a.useContext(T.K);return a.createElement(j,{annulus:t,sector:n,onClick:function(e){return r(h(o(e),t.center,n))},fillOpacity:0})},G=function(e){var t=e.observable,n=e.children,r=a.useState(void 0),o=r[0],u=r[1],c=a.useRef(0),i=function(){u(t()),c.current=requestAnimationFrame(i)};return a.useEffect(function(){return i(),function(){return cancelAnimationFrame(c.current)}},[]),o?n(o):null};var K={x:100,y:100};let R=function(e){var t=e.radius,n=void 0===t?[50,85,95]:t,r=n[0],o=n[1],u=n[2],c=e.levelSector,i=e.stageSector,s=void 0===i?{start:60,end:300}:i,l=e.src,f=e.width,d=e.height,p=a.useState(function(){return new V})[0];a.useEffect(function(){return p.playNew(l)},[l]),a.useEffect(function(){return p.stop},[]);var h={center:K,radius:[r,o]};return a.createElement(T.z,{viewBox:"0 0 ".concat(200," ").concat(200),width:f,height:d},a.createElement(M,{annulusSector:{center:K,radius:[r,o],sector:s},src:l+".json"}),a.createElement(G,{observable:p.getState},function(e){return a.createElement(N,{stageSector:s,innerAnnulus:h,outerAnnulus:{center:K,radius:[o,u]},state:e,toggle:p.toggle,src:l})}),a.createElement(B,{annulus:h,onChange:p.setVolume,stageSector:s,levelSector:void 0===c?{start:315,end:360}:c}),a.createElement(U,{annulus:h,sector:s,onClick:p.playAt}))};function W(){return(0,r.jsx)(R,{width:500,height:500,src:"https://nalchevanidze.com/assets/audio/david-alpha-black-hole"})}},1276:(e,t,n)=>{"use strict";n.d(t,{K:()=>u,z:()=>i});var r=n(4041),a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},u=r.createContext(function(){return{x:0,y:0}}),c=function(){return{x:0,y:0}},i=function(e){var t,n=e.children,i=o(e,["children"]),s=r.useState(!1)[1],l=r.useRef(null);return r.useEffect(function(){return s(!0)},[]),r.createElement("svg",a({},i,{ref:l}),r.createElement(u.Provider,{value:l.current?(t=l.current,function(e){var n,r=e.clientX,a=e.clientY,o=t.createSVGPoint();return o.x=r,o.y=a,o.matrixTransform(null===(n=t.getScreenCTM())||void 0===n?void 0:n.inverse())}):c},n))}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(8363)),_N_E=e.O()}]);